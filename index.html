<!DOCTYPE html>
<html lang="en" style="visibility: visible;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
		<title>suicideyear</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #000000;
				margin: 0px;
				overflow: hidden;
			}
		</style>
	<style type="text/css"></style></head>
	<body cz-shortcut-listen="true">

		<script src="js/three.min.js"></script>
		<script src="js/ThreeJsUtils.js"></script>

		<script src="js/OBJLoaderGEO.js"></script>
		<script src="js/OrbitControls.js"></script>
		<script src="js/FeedbackMaterial.js"></script>
		<script src="js/CustomShaders.js"></script>
		<script src="js/CCapture.min.js"></script>
		<script src="js/gif.js"></script>
		<script src="js/gif.worker.js"></script>
		<script src="js/Whammy.js"></script>
		<script id="vs" type="x-shader/x-vertex">

			uniform sampler2D map;

			uniform float width;
			uniform float height;
			uniform float nearClipping, farClipping;

			varying vec2 vUv;

			const float XtoZ = 1.11146; // tan( 1.0144686 / 2.0 ) * 2.0;
			const float YtoZ = 0.83359; // tan( 0.7898090 / 2.0 ) * 2.0;

			void main() {

				vUv = vec2( position.x / width, 1.0 - ( position.y / height ) );

				vec4 color = texture2D( map, vUv );
				float depth = ( color.r + color.g + color.b ) / 3.0;

				// Projection code by @kcmic

				float z = ( 1.0 - depth ) * (farClipping - nearClipping) + nearClipping;

				vec4 pos = vec4(
					( position.x / width - 0.5 ) * z * XtoZ,
					( position.y / height - 0.5 ) * z * YtoZ,
					- z + 1000.0,
					1.0);

				gl_PointSize = 1.0;
				gl_Position = projectionMatrix * modelViewMatrix * pos;

			}

		</script>
		<script id="testVs" type="x-shader/x-vertex">
			varying vec2 vUv;
			void main() {
			    vUv = uv;
			    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}
		</script>

		<script id="fs" type="x-shader/x-fragment">

			uniform sampler2D map;

			varying vec2 vUv;

			void main() {

				vec4 color = texture2D( map, vUv );
				// if((( color.r + color.g + color.b ) / 3.0) < 0.1){
					// discard;
				// } else {
					gl_FragColor = vec4( color.r, color.g, color.b, smoothstep( 8000.0, -8000.0, gl_FragCoord.z / gl_FragCoord.w ) );
				// }

			}

		</script>

		<script>

			var container;

			var scene, camera, light, renderer;
			var geometry, cube, mesh, material;
			var mouse, center;
			var stats;
			var container;
			var scene, renderer, camera, controls;
			var fbScene, fbRenderer, fbCamera, fbTexture, fbShaders, fbMaterial;
			var mouseX = 0, mouseY = 0;
			var time = 0;
			var texture;
			var windowHalfX = window.innerWidth / 2;
			var windowHalfY = window.innerHeight / 2;

			var start = Date.now(); 
			var gradient, tex;
			var meshes = [];
			var obj;
			var counter = 0;
			var rtt;
			var captureFrame = 0;
			var sizeMult = 1;
			var capturer = new CCapture( { format: 'webm', workersPath: 'js/' } );

			var video, texture;
			var isMobile = false;
			(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))isMobile = true})(navigator.userAgent||navigator.vendor||window.opera);

			init();
			fbInit();
			animate();

			function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );


				scene = new THREE.Scene();
				center = new THREE.Vector3();
				center.z = - 1000;

				camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 0.1, 100000 );
			    // camera = new THREE.OrthographicCamera( window.innerWidth / - 2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / - 2, -10000, 10000 );

				// camera.position.set( 0, 0, 1536.1264956669513 );
				camera.position.set( 0, 0, 1000 );
				controls = new THREE.OrbitControls(camera);
				scene.add( camera );

				video = document.createElement( 'video' );
				video.muted = true;
				texture = new THREE.Texture( video );
				texture.minFilter = texture.magFilter = THREE.NearestFilter;
				navigator.getUserMedia  = navigator.getUserMedia ||
                          navigator.webkitGetUserMedia ||
                          navigator.mozGetUserMedia ||
                          navigator.msGetUserMedia;
				if(isMobile){
					video.loop = true;
					video.src = 'textures/satin.mp4';
					video.play();
				} else {
					navigator.getUserMedia({audio:false, video:true}, function(stream){
						video.src = window.URL.createObjectURL(stream);
						video.play();
					}, function(err){
						console.log(err);
					});
				}
				// video.loop = true;
				// video.src = 'textures/IMG_0769.m4v';
				// video.src = 'textures/satin.mp4';
				// video.play();
				vidGeometry = new THREE.PlaneBufferGeometry(640, 480);
				vidMaterial = new THREE.MeshBasicMaterial({map: texture, transparent:true, opacity:0.0});
				vidMesh = new THREE.Mesh(vidGeometry, vidMaterial);
				vidMesh.position.z = 0;
				// mesh.visible = false;
				scene.add(vidMesh);
				video.addEventListener( 'loadedmetadata', function ( event ) {
					var width = 640, height = 480;
					var nearClipping = 850/*850*/, farClipping = 4000/*4000*/;

					// geometry = new THREE.Geometry();

					// for ( var i = 0, l = width * height; i < l; i ++ ) {
 
					// 	var position = new THREE.Vector3();
					// 	position.x = ( i % width );
					// 	position.y = Math.floor( i / width );

					// 	geometry.vertices.push( position );

					// }
					// geometry = new THREE.PlaneBufferGeometry(1000, 1000,500,500);
					// geometry = new THREE.PlaneBufferGeometry(window.innerWidth*2, window.innerHeight*2,500,500);
					// geometry = new THREE.IcosahedronGeometry(1000, 10);
					// geometry = new THREE.BoxGeometry(500,500,500,100,100,100);
					// geometry = new THREE.SphereGeometry(500,500,500);
					var testTex = THREE.ImageUtils.loadTexture("textures/testTex.jpg");
					// material = new THREE.ShaderMaterial( {

					// 	uniforms: {

					// 		"map": { type: "t", value: 0, texture: texture },
					// 		"test": { type: "t", value: testTex },
					// 		"width": { type: "f", value: width },
					// 		"height": { type: "f", value: height },
					// 		"nearClipping": { type: "f", value: nearClipping },
					// 		"farClipping": { type: "f", value: farClipping }

					// 	},
					// 	vertexShader: document.getElementById( 'vs' ).textContent,
					// 	fragmentShader: document.getElementById( 'fs' ).textContent,
					// 	// depthWrite: false

					// } );
					// if(isMobile){
						// material = new THREE.PointCloudMaterial({color: 0xffffff, side: 2, size: 5.0, /*transparent: true, opacity: 0.5*/});
	
					// } else {
						material = new THREE.PointCloudMaterial({map: texture, side: 2, size: 5.0, /*transparent: true, opacity: 0.5*/});

					// }
					// material = new THREE.MeshBasicMaterial({map: texture, side: 2});

					// mesh = new THREE.PointCloud( geometry, material );
				    var loader = new THREE.JSONLoader();
				    loader.load( 'obj/logo3.json', function( geometry, materials ) {
						mesh = new THREE.PointCloud( geometry, material );
						// mesh.scale.set(0.1,0.1,0.1);
						// mesh.rotation.x = Math.PI/2;
						mesh.position.y -= 75;
						scene.add( mesh );

				    });
					// mesh = new THREE.Mesh(geometry, material);
					// mesh.position.x = -500;
					// mesh.position.y = -500;
					// mesh.position.z = -1000;
					// mesh.rotation.z = Math.PI;


				}, false );


				renderer = new THREE.WebGLRenderer({preserveDrawingBuffer:true});
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.setClearColor(0x000000,1.0);
				// container.appendChild( renderer.domElement );

				mouse = new THREE.Vector3( 0, 0, 1 );
				// projector = new THREE.Projector();
				// ray = new THREE.Ray( camera.position );

				// renderer.autoClearColor = false;


				document.addEventListener( 'mousemove', onDocumentMouseMove, false );

			}

			function onDocumentMouseMove( event ) {

				mouse.x = ( event.clientX - window.innerWidth / 2 ) * 8;
				mouse.y = ( event.clientY - window.innerHeight / 2 ) * 8;

			    unMappedMouseX = (event.clientX );
			    unMappedMouseY = (event.clientY );
			    mouseX = map(unMappedMouseX, window.innerWidth, -1.0,1.0);
			    mouseY = map(unMappedMouseY, window.innerHeight, -1.0,1.0);
			    
			    
			    for(var i = 0; i < fbMaterial.fbos.length; i++){
			      // fbMaterial.fbos[i].material.uniforms.mouse.value = new THREE.Vector2(mouseX, mouseY);
			    }
    

			}

			function animate() {

				requestAnimationFrame( animate );

				render();
			    fbDraw();

			}

			function render() {
				texture.needsUpdate = true;
				time+=0.01;
				// camera.position.x += ( mouse.x - camera.position.x ) * 0.005;
				// camera.position.y += ( - mouse.y - camera.position.y ) * 0.005;
				// mesh.rotation.x += ( mouse.x*2.0*Math.PI - mesh.rotation.x ) * 0.005;
				// mesh.rotation.y += ( - mouse.y*2.0*Math.PI - mesh.rotation.y ) * 0.005;
				// camera.lookAt( center );
				// mesh.rotation.x = Math.sin(time*0.5)*0.5;
				mesh.rotation.y = Math.cos(time*0.5)*0.5;

				renderer.render( scene, camera );


			}

			function fbInit(){

			    fbScene = new THREE.Scene();
			    fbCamera = new THREE.OrthographicCamera( window.innerWidth / - 2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / - 2, -10000, 10000 );
			    fbCamera.position.set(0,0,0);

			    fbCamera2 = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.01, 100000);
			    fbCamera2.position.z = 750;

			    // controls = new THREE.OrbitControls(fbCamera2);


			    fbRenderer = new THREE.WebGLRenderer({ preserveDrawingBuffer: true/*, alpha: true*/});
			    fbRenderer.setClearColor(0xffffff, 1.0);
			    fbRenderer.setSize(window.innerWidth/sizeMult, window.innerHeight/sizeMult);
			    
			    container.appendChild(fbRenderer.domElement);

			    fbScene = new THREE.Scene();
			    

			    // canv = document.createElement("CANVAS");
			    // canv.width = window.innerWidth;
			    // canv.height = window.innerHeight;
			    // ctx = canv.getContext("2d");
			    // ctx.fillStyle = "white";
			    // ctx.fillRect(0,0,window.innerWidth, window.innerHeight);
			    // ctx.drawImage(renderer.domElement,0,0, window.innerWidth, window.innerHeight);
			    fbTexture = new THREE.Texture(renderer.domElement);
			    fbTexture.minFilter = fbTexture.magFilter = THREE.NearestFilter;
			    // fbTexture = THREE.ImageUtils.loadTexture("tex/rach.jpg")
			    // fbTexture = THREE.ImageUtils.loadTexture("tex/rgblcd.jpg");
			    // var clone = rtt.clone();
			    // fbMesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(window.innerWidth, window.innerHeight), new THREE.MeshBasicMaterial({map:fbTexture}));
			    // fbScene.add(fbMesh);

			    var customShaders = new CustomShaders();
			    var customShaders2 = new CustomShaders();

			    // fbShaders = [ 
			        // customShaders.blurShader, 
			        // customShaders.blurShader, 
			        // customShaders.diffShader2, 
			        // customShaders.blurShader, 
			        // customShaders2.passShader,
			        // customShaders.passShader
			    // ];

    		    fbShaders = [ 
			        customShaders.reposShader, 
			        customShaders.blurShader, 
			        customShaders.diffShader2, 
			        customShaders.reposShader, 
			        customShaders2.passShader,
			        customShaders.passShader
			    ];

			    // fbShaders = [ 
			    //     customShaders.reposShader, 
			    //     customShaders.flowShader, 
			    //     customShaders.diffShader2, 
			    //     customShaders2.reposShader, 
			    //     customShaders2.passShader,
			    //     customShaders.passShader
			    // ];

			    fbMaterial = new FeedbackMaterial(fbRenderer, fbScene, fbCamera, fbTexture, fbShaders);
			        
			    fbMaterial.init();


			    document.addEventListener( 'keydown', function(){screenshot(fbRenderer)}, false );
			    document.addEventListener( 'mousemove', onDocumentMouseMove, false );
			    // document.addEventListener( 'mousedown', onDocumentMouseDown, false );
			    // window.addEventListener( 'resize', onWindowResize, false );

			}
			function fbDraw(){
    
			    // ctx.fillStyle = "white";
			    // ctx.fillRect(0,0,window.innerWidth, window.innerHeight);
			    // ctx.drawImage(renderer.domElement, 0, 0, window.innerWidth, window.innerHeight);
			    time+=0.01;

			    for(var i = 0; i < fbMaterial.fbos.length; i++){
			      fbMaterial.fbos[i].material.uniforms.time.value = time;
			      fbMaterial.fbos[i].material.uniforms.mouse.value = new THREE.Vector2(Math.sin(time*0.5), Math.cos(time*0.5));
			    }
			    fbTexture.needsUpdate = true;
			        
			    fbMaterial.update();
			    // fbMaterial.expand(1.01);

			    fbRenderer.render(fbScene, fbCamera);

			    fbMaterial.getNewFrame();
			    fbMaterial.swapBuffers();

			    capturer.capture( fbRenderer.domElement );

			    
			}

		</script><div><canvas width="1440" height="743"></canvas></div>
	

</body></html>